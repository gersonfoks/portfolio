import{P as t}from"./PageHeading-66b90aa1.js";import{_ as a,r as i,o,c as s,a as n,F as r,b as h}from"./index-6a8c5de8.js";const l={components:{PageHeading:t}},c="/portfolio/projects/AiForHeartFailureDetection/architecture.png",d="/portfolio/projects/AiForHeartFailureDetection/resnet_results.png",u="/portfolio/projects/AiForHeartFailureDetection/confusion_matrix_resnet.png",p="/portfolio/projects/AiForHeartFailureDetection/ensemble_result.png",m="/portfolio/projects/AiForHeartFailureDetection/confusion_matrix_filtered_points.png",f=h('<div class="container"><div class="columns is-centered"><div class="column is-half-desktop is-two-thirds-mobile is-half-desktop content"><section class="section"><h1 class="title is-4"> Introduction </h1><p> In this challenge, we set out to estimate the NT-proBNP (N-terminal pro b-type natriuretic peptide) values based on ECG signals for earlier diagnosis of heart failure. The NT-proBNP value in someone&#39;s blood is an indication of heart failure. Getting someone&#39;s NT-proBNP value is costly and often not easily possible in some countries. Therefore, the objective was to create a model that would be able to recognize patients with elevated NT-proBNP values based on ECG signals, which in turn would allow for earlier diagnosis of heart failure. We succeeded to build deep learning models that were able to predict NT-proBNP values based on ECGs. We were also able to create an ensemble of models that can be used to take uncertainty into account, resulting in better usability of the model as a clinician could use the certainty of the model to make more informed decisions. </p></section><section class="section"><h1 class="title is-4">Context</h1><p> NT-proBNP is a hormone that is released by the heart muscle in response to changes in pressure. NT-proBNP is an indication of heart failure. The NT-proBNP values can range from 0 to 35.000 pg/ml. The higher the NT-proBNP value, the higher the risk of heart failure. For young adults a healthy NT-proBNP value is below 125 pg/ml. For people older than 75 it is below 450 pg/ml. The NT-proBNP value is measured with the help of blood samples. In some countries, the cost of measuring NT-proBNP is high or the tests aren&#39;t available. Therefore, we want to estimate the NT-proBNP value based on ECG signals. As ECG signals are easier to measure and the cost of measuring ECG signals is low, a machine learning model could be a good alternative for measuring NT-proBNP values. </p></section><section class="section"><h1 class="title is-4">Data and Preparation</h1><p> Catherina Hospital in Eindhoven has provided us with a dataset of ECG signals and corresponding measured NT-proBNP values. These measurements are taken from patients that have been admitted to the hospital with heart problems (e.g. heart defibrillation) and therefore the dataset has an underlying sampling bias. Nonetheless the dataset contains both patients with high and low NT-proBNP values, which allows us to train a model that can predict the NT-proBNP value based on ECG signals. For the data we had 10 second measurements of 250hz samples of each of the 12 ECG leads. As some leads are a linear combination of others we only took the independent leads into account. The data also included the BNP values corresponding to each ECG measurement, the datetime of the ECGs and NT-proBNP measurements, a hashed id per patient and their age. As there was a timestamp for each measurement it was possible to calculate the time between the heart rate measurements and the NT-proBNP measurements and exclude those rows with a too large time difference. Lastly, the NT-proBNP values seemed to lay on a log scale, so we took the log of the NT-proBNP values to make sure that the model would not be biased towards the higher values. </p><h2 class="title is-5">Approach</h2><p> During the challenge we tackled the problem in two ways. First we treat the problem as a regression problem and try to predict the NT-proBNP values directly. Secondly we treat the problem as a classification problem and try to predict whether the NT-proBNP values are in the healthy ranges or not (below 125 pg/ml or higher than 125 pg/ml). After a while we found out that regression worked as well as classification when converting the predicted values to the corresponding classes, and therefore we stuck to regression as it was more informative. We explored both traditional machine learning and deep learning approaches. Quickly we found out that deep learning methods out-performed classical methods and therefore we focused on deep learning. During our review of the literature we found that the main methods used when dealing with ECGs are either LSTMS, CNNs or a combination of both. Due to time constraints we focused on CNNs, because they tend to be easier to train and they tend to be faster. We used a resnet-like architecture which you can see in the image below: </p><figure class="image"><img src="'+c+'" alt="Resnet architecture"><figcaption class="is-size-7 has-text-centered"> Basic Resnet architecture used. </figcaption></figure><p> Lastly, in medical applications the certainty of the model is also important. If the model indicates high NT-proBNP values, but is not certain about it, a clinician should be aware of this as it helps with decision making. To get the uncertainty we trained an ensemble of 5 resnet-models. Each model is trained on a different partition of the dataset. We calculate the mean and the variance of the predictions of the models. The variance of the predictions is used as the uncertainty. Then we can filter out points that have the threshold of healthy NT-proBNP values (125 pg/ml) in the interval of [mean of predictions - 2 * standard deviation, mean of predictions + 2 * standard deviation]. For these points we can indicate that the model is too uncertain about the prediction. For the other points we use the mean of the prediction as the final prediction. </p></section><section class="section"><h1 class="title is-4">Results</h1><p> Below you can see the results of the model on the validation set. As you can see the model is capturing the relation between the ECG signals and the NT-proBNP. It achieves a accuracy of 0.83 on the validation set. Furthermore the f1 score is 0.82. Unfortunately it achieves high false negatives. Whenever the model says that the NT-proBNP values are below 125 it is only correct about 65% of the time. Which is undesirable as this leads to patients not being diagnosed with elevated risk of heart failure when they actually have an elevated risk. </p><figure class="image"><img src="'+d+'" alt="Resnet Results"><figcaption class="is-size-7 has-text-centered"> Result of the resnet on the validation set. </figcaption></figure><figure class="image"><img src="'+u+'" alt="Resnet confusion matrix"><figcaption class="is-size-7 has-text-centered"> Confusion matrix resnet. </figcaption></figure> A solution is to use the ensemble method and take the uncertainty into account. Below you can see the confusion matrix as well as the predictions from the ensemble with the points that we are uncertain about filtered out. For the ensemble we see that we get better scores on the points that we are certain about. For example the accuracy goes up to 0.93, furthermore the f1-score goes up to 0.92. Lastly the false negatives rate goes down to 0.16 and thus about 84% of the time the model says that the nt-proBNP values are below 125 they actually are. This is an significant improvement. <figure class="image"><img src="'+p+'" alt="Ensemble Results"><figcaption class="is-size-7 has-text-centered"> Result of the ensemble on the validation set with uncertain points taken out. The points the models are uncertain about is the points for which 125 lies in the interval: [mean of predictions - 2 * standard deviation, mean of predictions + 2 * standard deviation]. </figcaption></figure><figure class="image"><img src="'+m+'" alt="Resnet confusion matrix"><figcaption class="is-size-7 has-text-centered"> Confusion matrix of the filtered points. </figcaption></figure><p> We thus see that using an ensemble together with the uncertainty of the prediction can be used for helping the clinician with decision making. Whenever the model is uncertain about the prediction, the clinician can decide to take another measurement or to do follow up tests. Whenever the model indicates, with certainty, a too high NT-proBNP value, the clinician can take action to prevent heart failure. A prediction that indicates a healthy NT-proBNP value can be used as in indication that the patient is healthy, but the clinician should be aware of the relatively high false negative rate. </p></section><section class="section"><h1 class="title is-4">Conclusion</h1><p> In this project we set out to predict the NT-proBNP values from ECG signals. We found that it is possible to predict the NT-proBNP values from ECG signals with a high accuracy. Furthermore we found that the model is able to capture the relation between the ECG signals and the NT-proBNP values. However, the model has a high false negative rate. This can be partially fixed by using an ensemble and taking the uncertainty into account, which ultimatelly could help the clinician with decision making. </p></section></div></div></div>',1);function g(w,b,v,N,y,T){const e=i("PageHeading");return o(),s(r,null,[n(e,{title:"Ai For Heart-failure detection"}),f],64)}const _=a(l,[["render",g]]);export{_ as default};
